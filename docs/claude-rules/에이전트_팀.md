# 에이전트 & 팀 상세 규칙

> CLAUDE.md 요약본의 상세 버전. 에이전트 관련 작업 시 참조.

## 에이전트 구조 (2026-02-25 확정)

### 현재 조직 (6명)
| 역할 | 이름 | 구 이름 |
|------|------|--------|
| 비서실장 | 비서실장 | 동일 |
| 투자분석 | **금융분석팀장** | CIO(투자분석처장) |
| 법무 | **법무팀장** | CLO(법무처장) |
| 사업기획 | **전략팀장** | CSO(사업기획처장) |
| 마케팅 | **마케팅팀장** | CMO(마케팅처장) |
| 출판·기록 | **콘텐츠팀장** | CPO(출판처장) |

## 처장 = 5번째 분석가! (CEO 핵심 아이디어)
- **모든 부서 처장은 전문가와 별개로 독자 분석을 병렬 수행**
- 구조: [처장 독자분석 + 전문가 N명] 병렬 gather → 전부 합쳐서 종합
- 이 구조를 깨뜨리는 코드 변경 절대 금지 | 코드: `_manager_with_delegation()` in arm_server.py

## 전문가급
- soul/yaml 보존 (회사 자산), UI에서는 제거
- 재도입 시점: 팀장 혼자 30분+ + 병렬이 실제로 의미 있을 때
- **그 시점이 오면 명시적으로 조언.** 매 작업마다 언급 금지.

## 리팩토링 시점 조언
- arm_server.py 또는 핵심 파일이 **3,000줄 초과** 시 → 세션 시작 때 리팩토링 BACKLOG 추가 언급
- 단, 매 작업마다 언급 금지. 줄수 초과 시에만.

## 에이전트 소울
- 로드: ①`config/agents.yaml` system_prompt → ②`souls/agents/*.md` 폴백 | 웹 수정 불가

## 매매 설정 — 건드리지 마!
- `order_size: 0` = CIO 비중 자율 (정상!). 0을 다른 값으로 바꾸지 말 것

## 🔴 팀 에이전트 운용 기준

### 언제 쓰나
- 조사 + 수정 + 검증이 **동시에** 필요할 때
- 한 사람이 하면 컨텍스트가 너무 길어질 때 (파일 3개 이상 + API 테스트 + 로그 확인)
- 버그 원인이 불분명해서 병렬 분석이 필요할 때

### 표준 팀 구성 예시

**버그 수정 팀:**
```
investigator (Explore) → 원인 분석, 관련 파일 전수 조사
팀장(나) → 수정 + 실서버 검증
```

**기능 개발 팀:**
```
researcher (Explore) → 코드베이스 파악 + 관련 파일 정리
builder (general-purpose) → 실제 구현
팀장(나) → 통합 + 검증 + 보고
```

### 운용 절차
1. `TeamCreate` → 팀 생성
2. `Agent` (run_in_background=true) → 팀원 투입
3. 팀원 분석 완료 → 자동 보고 수신
4. 수정 적용 → `WebFetch`로 실서버 검증
5. 통과 후 대표님 보고

### 주의
- investigator는 Explore 타입 (읽기 전용). 직접 코드 수정 불가
- 수정은 반드시 팀장(나) 또는 general-purpose 에이전트가 담당
- 팀 완료 후 `TeamDelete`로 정리

## 워크플로우 예측 (대표님 발명)
- 새 기능 → 코드 전수검사 → 워크플로우 예측 → 선제 보강 → 실제 테스트 → 로그 비교
- 저장: `docs/workflow-predictions/` | 상세: `docs/methodology/workflow-prediction.md`
