# 코딩 & 개발 상세 규칙

> CLAUDE.md 요약본의 상세 버전. 코딩 작업 시 참조.

## Git 규칙
- `origin/main` 기준 새 브랜치: `claude/작업명` | 마지막 커밋 `[완료]` → 자동 머지
- 중간에도 수시 커밋+푸시 | 기존 브랜치에 무관한 작업 추가 금지

## 파일 수정 규칙
- `web/templates/index.html` — Write 전체 덮어쓰기 절대 금지 → Edit 부분 수정만

## 토큰 절약
- 파일 탐색: **Glob/Grep 직접 사용** 우선. 서브에이전트는 직접 검색 3회 이상 실패 시에만
- `project-status.md`는 최근 2주 기록만 유지. 이전 → `docs/archive/project-status-archive.md`

## 하드코딩 금지
- 모델명 정의: `config/agents.yaml` + `config/models.yaml` 2곳만. 코드에 직접 쓰기 금지
- **모델 변경 시 10곳 체크리스트**: `docs/claude-reference.md`

## 외부 API
- 모든 외부 API 코드 작성/수정 시 WebSearch로 최신 공식 문서 확인. 기억 의존 금지
- KIS: [API 포털](https://apiportal.koreainvestment.com) | Anthropic: [Extended Thinking](https://docs.claude.com/en/docs/build-with-claude/extended-thinking)

## UI/UX 규칙
- 한국어 | KST | Tailwind + Alpine.js | `hq-*` 컬러 토큰
- **폰트**: Pretendard + JetBrains Mono 2개만. 새 Google 폰트/`font-sans` 오버라이드 금지

## 웹 성능 코딩 규칙
1. CDN 라이브러리는 `_loadScript()` 동적 로드만. blocking `<script>` 금지
2. 새 탭은 `<template x-if>` 필수 (x-show는 home/command/schedule/knowledge만)
3. init()에 API 추가 금지 → `switchTab()` lazy load
4. 폰트 추가 금지 | CSS @import 금지 → preload
5. SSE 1개만 (`_connectCommsSSE()`) | setInterval은 탭 진입/이탈 관리

## 새 기능 구현 — 최신 레퍼런스 분석 필수!

**"그냥 만들기" 금지. 구현 전에 반드시:**

1. **최신 업계 표준 검색**: WebSearch로 "best practices [기능명] 2026" 검색
2. **오마주 분석 3단계**: ① 무엇이 좋은가 ② 왜 좋은가 ③ 어떻게 빌릴 건가 (Alpine.js+Tailwind 제약 내)
3. **결과물 기준**: "이 업계 도구와 비교해도 손색없다" 수준
- 레이아웃: 동일 카테고리 최고 앱 3개 스크린샷 분석 후 차용
- 에러 처리: 빈 상태 / 로딩 스켈레톤 / 에러 메시지 UX 참조
> 상세: `docs/ux-references.md`

## 다이어그램 — HTML 뷰어 필수!
- 다이어그램/플로우차트 생성 시 반드시 3벌: `.md` + `.html` + `file:///` URL 전달
- html 규칙: mermaid.js CDN + dark 테마 + `useMaxWidth: false` + 섹션별 카드 레이아웃
- 참고: `docs/architecture/tool-server-flow.html`
