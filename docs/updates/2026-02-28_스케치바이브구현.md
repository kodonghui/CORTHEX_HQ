# 2026-02-28 — SketchVibe MVP 구현

## 요약
캔버스에 스케치 + 자연어 → Claude → Mermaid 다이어그램 변환 파이프라인 구현.

## 변경 파일

| 파일 | 변경 | 줄수 |
|------|------|------|
| `web/handlers/sketchvibe_handler.py` | 신규 | ~230줄 |
| `web/arm_server.py` | 라우터 마운트 추가 | +4줄 |
| `web/static/js/corthex-app.js` | 데이터 변수 + 메서드 5개 | +128줄 |
| `web/templates/index.html` | 토글 버튼 + 스케치바이브 패널 | +100줄 |

## 구현 내용

### 백엔드 (`sketchvibe_handler.py`)
- `POST /api/sketchvibe/convert` — 캔버스 JSON + 자연어 → Mermaid 변환
  - Drawflow JSON 파싱 → 노드/연결 텍스트 추출
  - Claude 시스템 프롬프트: 타입 자동 판단(flowchart/graph) + Mermaid 코드 생성
  - JSON 응답 파싱 (```json 블록 + 중첩 {} 추적)
- `GET /api/sketchvibe/canvas` — MCP용 최근 캔버스 상태 반환
- `POST /api/sketchvibe/save-diagram` — 확인된 다이어그램 .md + .html 저장

### 프론트엔드
- 캔버스 모드에 "스케치바이브" 토글 버튼 추가
- 오른쪽 슬라이드 패널 (w-96):
  - 자연어 입력 textarea
  - 변환하기 버튼 (로딩 스피너)
  - Mermaid 렌더링 결과 뷰어
  - "맞아 ✓" / "다시 해줘 ↩" 확인 버튼
  - 비용 표시 + 타입 배지
- Mermaid CDN 동적 로드 (dark 테마, useMaxWidth: false)

### UX
- 타입 선택 UI 없음 — AI가 자동 판단
- "맞아" → 다이어그램 이름 입력 → .md + .html 뷰어 저장 (knowledge/sketchvibe/)
- 슬라이드 애니메이션 (translate-x-full → translate-x-0)

## 파이프라인 (8단계)
```
① 캔버스에 노드 배치 + 선 연결
② Drawflow JSON 자동 생성
③ 자연어 설명 입력
④ "변환하기" → POST /api/sketchvibe/convert
⑤ Claude가 타입 자동 판단 (flowchart/graph)
⑥ Mermaid 코드 생성 + 해석 반환
⑦ "맞아 / 다시 해줘" 확인
⑧ 저장 (.md + .html 뷰어)
```

## 미구현 (Phase 2)
- MCP 서버 (별도 프로세스) — REST API로 대체 중
- 복잡한 스케치 정확도 향상
- "맞아" 후 실제 코드 구현 자동 착수
