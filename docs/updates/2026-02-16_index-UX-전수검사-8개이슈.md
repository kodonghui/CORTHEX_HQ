# index.html UX 전수검사 — 8개 이슈 수정

## 버전
0.12.002

## 작업 날짜
2026-02-16

## 작업 브랜치
claude/fix-multi-provider-ai-chat

## 변경 사항 요약

### 수정한 파일
- `web/templates/index.html` (메인 웹 화면) — 8개 이슈 수정

### 1. [버그] 부서 필터 버그 수정
- **문제**: 기밀문서 탭에서 부서 필터를 바꿔도 이전에 클릭한 보고서가 계속 표시됨
- **해결**: `loadArchive()` 함수 시작 부분에 `archive.content`와 `archive.selectedReport`를 초기화하는 코드 추가. 필터 변경 시 이전 보고서가 사라지고 새로 선택해야 함

### 2. [버그] 사령실 채팅 스크롤
- **문제**: 다른 탭 갔다가 사령실로 돌아오면 채팅이 맨 아래로 안 감
- **해결**: `switchTab()` 함수에서 `command` 탭으로 전환할 때 `$nextTick(() => scrollToBottom())` 호출 추가

### 3. [버그] 피드백(따봉) 토글 시각 개선
- **문제**: 피드백 버튼 선택 상태가 시각적으로 부족함
- **해결**: 좋아요 선택 시 초록색 배경+테두리(ring), 아쉬워요 선택 시 빨간색 배경+테두리 효과 추가
- **참고**: 토글 로직(같은 버튼 재클릭=취소, 다른 버튼=변경)은 이미 구현되어 있었음

### 4. [버그] CTO 소울 웹 연동 확인
- **결과**: 프론트엔드 소울 코드 점검 완료. 에이전트 상세 로드 시 `system_prompt` 데이터를 소울 탭에 정상 표시하고, PUT /api/agents/{id}/soul로 저장하는 코드 모두 정상

### 5. [UX] 기밀문서(CLASSIFIED) 2단 레이아웃
- **문제**: 보고서 목록과 내용이 위아래로 나열되어 스크롤이 많이 필요
- **해결**: 이메일 앱 스타일로 변경 — 왼쪽 1/3에 카드 목록 + 오른쪽 2/3에 보고서 내용. 부서 필터는 왼쪽 상단에 sticky(고정). 보고서 미선택 시 "왼쪽에서 보고서를 선택하세요" 안내 표시

### 6. [디자인] 글씨체 Pretendard 통일
- **문제**: 보고서 본문이 'Noto Serif KR'(명조체)로 되어 있어 다른 UI와 분위기가 다름
- **해결**: `.markdown-body` 기본 font-family를 `'Pretendard Variable', 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, sans-serif`로 변경. 코드블록은 기존 JetBrains Mono 유지

### 7. [디자인] 보고서 이미지 CSS
- **추가**: `.markdown-body img`에 `max-width: 100%`, 둥근 모서리(8px), 간격(1em), 테두리(흰색 10% 반투명) 스타일 추가. 보고서에 이미지가 있을 때 깔끔하게 표시됨

### 8. [디자인] ■ 네모 디자인 + 층위 구분
- **문제**: 보고서의 `■ 상위항목`과 `■ 하위항목`이 같은 스타일이라 계층이 구분 안 됨
- **해결**: `renderMarkdown()` 함수에서 `■` 문자를 글로우 배지(`<span class="badge-marker">`)로 변환하는 후처리 추가. CSS로 계층별 색상 구분:
  - 1단계(최상위): 보라색 그라데이션 + 보라색 글로우
  - 2단계(중첩): 시안색 그라데이션 + 시안색 글로우
  - 3단계(이중 중첩): 초록색 그라데이션 + 초록색 글로우

## 현재 상태
- 8개 이슈 모두 수정 완료
- 커밋 + 푸시 진행 중

## 다음에 할 일
- 배포 후 서버에서 확인
- 키움증권 API 연동
- 노션 API 키 등록
