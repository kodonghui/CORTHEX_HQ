# Gemini 추론 레벨 수정 + 에이전트 카드 표시 개선

## 작업 날짜
2026-02-15

## 작업 브랜치
`claude/fix-gemini-reasoning-agent-display`

## 변경 사항 요약

### 1. Gemini 모델 추론 레벨 최신 정보 반영

Google AI 공식 문서를 조사해서, Gemini 모델 3개의 추론 레벨(생각하는 깊이)을 정확하게 설정했습니다.

| 모델 | 추론 레벨 | 설명 |
|------|----------|------|
| **Gemini 3.0 Pro Preview** | low, high | 최신 모델. `thinking_level` 파라미터 사용. low/high 2단계만 지원 |
| **Gemini 2.5 Pro** | low, medium, high | `thinking_budget` 파라미터 사용. 최소 128토큰, 끌 수 없음 |
| **Gemini 2.5 Flash** | none, low, medium, high | `thinking_budget` 파라미터 사용. 0으로 설정하면 추론 끌 수 있음 |

**수정한 파일:**
- `config/models.yaml` (모델 설정 파일) — Google provider 섹션 추가, Gemini 3개 모델에 `reasoning_levels` 설정
- `web/mini_server.py` (서버 프로그램) — 모든 모델에 `reasoning_levels` 필드 추가 (기존엔 없었음)

### 2. 에이전트 모델 변경 시 카드에 즉시 반영되지 않던 버그 수정

**문제**: 에이전트 설정에서 모델이나 추론 레벨을 바꿔도, 사무실 화면의 에이전트 카드(작은 네모 칸)에는 예전 정보가 그대로 보였음.

**원인**: 모달(팝업 창) 안의 데이터만 바뀌고, 바깥 화면의 카드 데이터는 안 바뀌는 코드 구조였음.

**해결**:
- 모델/추론 변경 후 `_updateAgentCardLabel()` 함수를 호출해서 카드도 즉시 갱신
- `/api/agents` 목록 API에서도 DB에 저장된 오버라이드(변경사항)를 반영하도록 수정

**수정한 파일:**
- `web/templates/index.html` (화면 파일) — 카드 업데이트 로직 추가
- `web/mini_server.py` (서버 프로그램) — `/api/agents` 응답에 오버라이드 반영
- `web/app.py` (메인 서버) — `/api/agents` 응답에 `reasoning_effort` 필드 추가

### 3. 에이전트 카드 모델명 표시 형식 개선

**이전**: `claude-sonnet-4-5-20250929` (개발자용 원본 이름)
**이후**: `Claude Sonnet 4.5 (medium)` (보기 좋은 이름 + 추론 레벨)

**수정한 파일:**
- `web/templates/index.html` (화면 파일) — `_getDefaultReasoning()`, `_updateAgentCardLabel()` 헬퍼 함수 추가

## 현재 상태
- ✅ 작업 완료
- ✅ GitHub에 push 완료
- ✅ main에 머지되면 서버에 자동 배포됨

## 다음에 할 일
- 29명 에이전트 소울(성격) 설정 — `docs/TODO-에이전트-설정.md` 참고
- 노션 보고 시스템 구현
