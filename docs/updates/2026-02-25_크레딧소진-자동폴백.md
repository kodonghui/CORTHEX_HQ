# AI 프로바이더 크레딧 소진 시 자동 폴백 (2026-02-25)

## 문제
- Anthropic API 크레딧 소진 → 400 "credit balance too low" 에러
- 기존: 로그만 찍고 에러 반환 (다른 프로바이더로 전환 안 됨)
- `_pick_fallback_model()`이 항상 Anthropic 1순위 → 소진돼도 다시 Anthropic 선택

## 수정 내용

| 파일 | 수정 |
|------|------|
| `web/ai_handler.py` | 400 크레딧 에러 감지 → Google/OpenAI 자동 전환 |
| `web/ai_handler.py` | `mark_provider_exhausted()` — 소진 프로바이더 세션 동안 기억 |
| `web/ai_handler.py` | `_pick_fallback_model(exclude=)` — 소진 프로바이더 제외 |
| `web/ai_handler.py` | `select_model()` — 소진 프로바이더 건너뛰기 |
| `web/arm_server.py` | `/api/debug/ai-providers` — 소진 상태 표시 |
| `web/arm_server.py` | `/api/debug/reset-exhausted-providers` — 충전 후 리셋 API |

## 동작 흐름
1. Anthropic 호출 → 400 "credit balance" 에러 감지
2. `mark_provider_exhausted("anthropic")` → 세션 동안 기억
3. Google(Gemini) 또는 OpenAI로 즉시 폴백
4. 이후 모든 호출에서 Anthropic 건너뜀 (매번 실패 반복 방지)
5. 크레딧 충전 후: `/api/debug/reset-exhausted-providers` 호출로 리셋

## 배포
- PR #577 → auto-merge → 빌드 대기
