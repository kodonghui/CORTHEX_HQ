# 빌드 번호 불일치 문제 해결

## 작업 날짜
2026-02-15

## 작업 브랜치
claude/fix-allowed-tools-logic-943fa2

## 변경 사항 요약

### 뭘 했는지
웹 화면에 표시되는 **빌드 번호가 두 군데에서 서로 다른 숫자**를 만들고 있던 문제를 해결했습니다.

### 문제가 뭐였는지
| 위치 | 방식 | 결과 |
|------|------|------|
| `deploy.yml` (배포 스크립트) | GitHub Actions 실행 횟수 | **빌드 #37** |
| `mini_server.py` (서버 코드) | Git 커밋 총 개수 | **빌드 #399** |

같은 "빌드 번호"인데 **37 vs 399**로 완전히 다른 숫자가 나와서 혼란이 있었습니다.

### 어떻게 해결했는지
- `mini_server.py`에서 Git 커밋 개수로 빌드 번호를 만드는 코드를 **삭제**했습니다
- 이제 빌드 번호는 **오직 `deploy.yml`의 GitHub Actions 실행 번호** 하나만 사용합니다
- 로컬 개발 환경(배포 전)에서는 "dev"로 표시됩니다
- `CLAUDE.md`(작업 규칙 파일)에도 "Git 커밋 개수를 빌드 번호로 사용하지 말 것" 규칙을 추가했습니다

### 수정한 파일
1. `web/mini_server.py` (서버 코드) — `get_build_number()` 함수에서 git 커밋 개수 방식 제거, "dev" 폴백으로 변경
2. `CLAUDE.md` (작업 규칙) — 빌드 번호 규칙 섹션 업데이트 (소스는 오직 deploy.yml)
3. `docs/project-status.md` (프로젝트 현황) — 알려진 문제점에 해결 기록, 중요 결정 사항에 규칙 추가

## 현재 상태
- 작업 완료
- 커밋 후 자동 배포 예정
- 배포 후 웹 화면에서 빌드 번호가 정상적인 숫자(#38 등)로 표시될 것

## 다음에 할 일
- 배포 후 `http://168.107.28.100` 접속하여 빌드 번호 정상 표시 확인
- `http://168.107.28.100/deploy-status.json`에서도 동일한 빌드 번호 확인
