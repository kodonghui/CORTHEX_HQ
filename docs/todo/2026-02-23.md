# 2026-02-23 TODO

> 2/22 미완료 항목 이관 + 리팩토링 진행

---

## ✅ 2/23 완료

### 리팩토링 Step 1: 브로드캐스트 헬퍼 추출
- ✅ `web/ws_manager.py` 생성 (방송실 — 브로드캐스트 코드 1곳으로 통합)
- ✅ `mini_server.py` 30곳 복사-붙여넣기 코드 → `wm.broadcast()` 1줄 호출로 교체
- ✅ PR#493 머지 + 배포

### 노션 corthex.hq 전환
- ✅ .env.local 노션 API 키 교체 (elddlwkd → corthex.hq)
- ✅ GitHub Secrets 4개 업데이트 (NOTION_API_KEY, DB_SECRETARY, DB_OUTPUT, DEFAULT_DB_ID)
- ✅ corthex.hq 노션 페이지 2개 업데이트 (아키텍처 + 기술 문서)

### 문서 작성
- ✅ CLAUDE.md: 메모리 금지 규칙 최상단 추가
- ✅ CLAUDE.md: 기술 설명 규칙 추가 (비유 필수, 구체적 숫자 등)
- ✅ `docs/refactoring-guide.md`: 비개발자용 리팩토링 가이드 (왜/어떻게/뭐가좋아지나)
- ✅ `docs/ceo-ideas.md`: #005 메모리 금지 원칙 + #006 리팩토링 설명 원칙
- ✅ `docs/project-status.md` 업데이트

---

## 🔄 진행중

### 리팩토링 Step 2: 전역 상태 관리 모듈 (AppState)
- ⬜ `web/state.py` 생성
- ⬜ 44개 전역 변수 → `AppState` 클래스로 이동
- ⬜ `asyncio.Lock` 추가 (레이스컨디션 방지)
- ⬜ `mini_server.py`에서 `global` 키워드 전부 제거
- ⬜ 배포 + 서버 정상 확인

---

## ⬜ 리팩토링 예정

| Step | 비유 | 내용 | 상태 |
|------|------|------|------|
| 3 | 메모리 청소 | 메모리 누수 수정 + AI 타임아웃 | ⬜ |
| 4 | 에러 잡기 | `except pass` 40곳 → 구체적 로깅 | ⬜ |
| 5~7 | 부서별 분리 | 핸들러 모듈 분리 (미디어/SNS/에이전트 등) | ⬜ |
| 8 | AI 정리 | ai_handler.py 리팩토링 | ⬜ |
| 9~12 | 마무리 | Config 통합, 인증, 테스트, HTML 분리 | ⬜ |

상세: `docs/REFACTORING_PLAN.md`

---

## ➡️ 2/22에서 이관 (리팩토링 외)

### 대표님이 직접 해야 할 것 🔴
- ⬜ 유튜브 채널 생성 → OAuth 연동
- ⬜ 네이버 카페 CLUB_ID, MENU_ID 확인 → GitHub Secrets에 등록
- ⬜ 이미지 스타일 레퍼런스 제공 (원하는 느낌의 이미지 2~3장)
- ⬜ Kling 3.0 API 키 발급 (https://klingai.com)
- ⬜ Replicate API 토큰 발급 → GitHub Secrets `REPLICATE_API_TOKEN`

### Claude가 할 것 (리팩토링 후)
- ⬜ Kling 3.0 영상 생성기 구현
- ⬜ 이미지 스타일 개선 (미니멀 전환)
- ⬜ 네이버 블로그/티스토리 발행 테스트
- ⬜ 도구 전면 재건 (209개 → ~114개)

### 전수검사 미수정 항목
- ⬜ P2-2: 교신로그 탭 전환 버그
- ⬜ P2-3: 교신로그 도구 사용 표시
- ⬜ P2-4~P2-12 (9건)
- ⬜ 직원 모델 설정 '권장' 버튼 안 먹힘

### 장기
- ⬜ 사령관실 내부통신 C안
- ⬜ 전략실 교신로그 C안
