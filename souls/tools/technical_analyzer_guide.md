# technical_analyzer — 교수급 기술적 분석 도구 가이드

## 이 도구는 뭔가요?
대학교 금융공학 교수가 직접 분석하는 것처럼, **30개 이상의 기술적 지표**를 한 번에 종합 분석해주는 도구입니다.
kr_stock의 `action=indicators`가 기본 3~4개 지표만 보여준다면, 이 도구는 추세/모멘텀/변동성/거래량/캔들패턴/지지저항/매매신호까지 **7개 영역을 모두 커버**합니다.

## kr_stock의 indicators와 뭐가 다른가요?
| 항목 | kr_stock (indicators) | technical_analyzer |
|------|----------------------|-------------------|
| 지표 수 | RSI, MACD, 볼린저, 이동평균 (4개) | **30개+** (아래 전체 목록 참조) |
| 캔들 패턴 | 없음 | 도지, 해머, 엔걸핑 등 10종 |
| 지지/저항선 | 없음 | 피봇포인트, 피보나치, MA 지지/저항 |
| 매매 점수 | 없음 | 0~100 종합 점수 + 강한매수/매수/관망/매도/강한매도 |
| AI 종합 분석 | 없음 | LLM이 교수급 해설 생성 |

## 어떤 기술을 쓰나요?
- **pykrx** — 한국거래소 OHLCV(시가/고가/저가/종가/거래량) 데이터
- **pandas-ta** — 기술적 지표 자동 계산 (30개+)
- **numpy** — 통계 계산 (표준편차, 피보나치 비율 등)
- **LLM 분석** — 지표 결과를 교수급 언어로 해설
- 비용: **주식 데이터 무료** + LLM 호출 비용 (GPT-5.2 기준 약 $0.01/분석)

## 사용법

### action=full (전체 종합 분석) — 가장 많이 쓰게 될 액션
```
action=full, name="삼성전자"
```
- 추세 + 모멘텀 + 변동성 + 거래량 + 캔들패턴 + 지지저항 + 매매신호를 **한 번에** 분석
- 마지막에 LLM이 교수급 종합 의견을 덧붙임

### action=trend (추세 분석)
```
action=trend, name="삼성전자", days=200
```
분석 지표:
| 지표 | 뭔가요? | 활용법 |
|------|--------|--------|
| MA (5/10/20/60/120/200일) | 이동평균선 — 평균 가격 | 단기선 > 장기선 = 상승 추세 |
| EMA (12/26/50일) | 지수이동평균 — 최근 가격에 가중치 | MA보다 빠르게 추세 전환 감지 |
| ADX | 추세 강도 (0~100) | 25 이상이면 "확실한 추세 있음" |
| Parabolic SAR | 추세 반전 포인트 | SAR이 가격 아래 → 상승, 위 → 하락 |

### action=momentum (모멘텀 분석)
```
action=momentum, name="카카오"
```
분석 지표:
| 지표 | 뭔가요? | 활용법 |
|------|--------|--------|
| RSI (14일) | 과매수/과매도 (0~100) | 70+ = 과매수, 30- = 과매도 |
| MACD | 추세 전환 신호 | MACD > 시그널 = 매수, < = 매도 |
| Stochastic | 현재가의 상대적 위치 (0~100) | 80+ = 과매수, 20- = 과매도 |
| CCI | 평균에서 얼마나 벗어났나 | +100 이상 = 과매수, -100 이하 = 과매도 |
| Williams %R | Stochastic과 비슷 (0~-100) | -20 위 = 과매수, -80 아래 = 과매도 |
| ROC | 가격 변화율 | 양수 = 상승 모멘텀, 음수 = 하락 |
| MFI | 자금 흐름 (거래량 가중 RSI) | 80+ = 자금 과잉 유입, 20- = 유출 |

### action=volatility (변동성 분석)
```
action=volatility, name="NAVER"
```
분석 지표:
| 지표 | 뭔가요? | 활용법 |
|------|--------|--------|
| 볼린저밴드 | 가격 변동 범위 (상단/중간/하단) | 밴드폭 좁아지면 → 곧 큰 움직임 예상 |
| ATR (14일) | 평균 일일 변동폭 | 값이 크면 변동성 높은 종목 |
| 역사적 변동성 | 20일 수익률의 표준편차 | 연율화해서 %로 표시 |

### action=volume (거래량 분석)
```
action=volume, name="현대차"
```
분석 지표:
| 지표 | 뭔가요? | 활용법 |
|------|--------|--------|
| OBV | 거래량 누적 방향 | 가격은 횡보인데 OBV 상승 → 조만간 상승 |
| CMF (20일) | 자금 유출입 (-1~+1) | 양수 = 매수세, 음수 = 매도세 |
| A/D Line | 매집/배분 | 가격 하락 중 A/D 상승 → 누군가 매집 중 |
| 거래량 MA | 5/20일 거래량 평균 | 현재 거래량이 평균보다 높으면 관심 증가 |

### action=pattern (캔들 패턴 분석)
```
action=pattern, name="삼성SDI"
```
감지하는 패턴:
| 패턴 | 뭔가요? | 의미 |
|------|--------|------|
| Doji (도지) | 시가 = 종가 (십자 모양) | 추세 전환 가능성 |
| Hammer (해머) | 아래꼬리 긴 양봉 | 하락 후 반등 신호 |
| Inverted Hammer | 위꼬리 긴 양봉 | 상승 전환 가능성 |
| Engulfing (장악형) | 전일 몸통을 감싸는 큰 봉 | 강한 추세 전환 |
| Morning Star (샛별) | 3봉 패턴 (음봉→작은봉→양봉) | 바닥 반전 |
| Evening Star (저녁별) | 3봉 패턴 (양봉→작은봉→음봉) | 천장 반전 |
| Three White Soldiers | 연속 3양봉 | 강한 상승 |
| Three Black Crows | 연속 3음봉 | 강한 하락 |
| Harami (잉태형) | 전일 몸통 안에 작은 봉 | 추세 약화 |
| Spinning Top (팽이) | 위아래 꼬리 긴 작은 몸통 | 방향성 불확실 |

### action=support_resistance (지지/저항선 분석)
```
action=support_resistance, name="LG에너지솔루션"
```
분석 방법:
| 방법 | 뭔가요? | 활용법 |
|------|--------|--------|
| 피봇 포인트 | 전일 고가/저가/종가로 계산 | 당일 지지/저항 기준점 (단기 트레이딩) |
| 피보나치 되돌림 | 최고-최저의 23.6%/38.2%/50%/61.8% | 조정 시 반등 예상 가격대 |
| MA 지지/저항 | 이동평균선이 지지/저항 역할 | 가격이 MA 근처에서 반등/저항 |

### action=signal (매매 신호 종합) — CIO가 가장 자주 쓸 액션
```
action=signal, name="삼성전자"
```
- 8개 핵심 지표(RSI, MACD, Stochastic, ADX, 볼린저, OBV, MA 크로스, 캔들패턴)를 각각 -2~+2 점수로 평가
- 전체를 0~100 점수로 정규화
- **점수 해석**: 80+ = 강한매수 / 60~80 = 매수 / 40~60 = 관망 / 20~40 = 매도 / 0~20 = 강한매도

---

## 이 도구를 쓰는 에이전트들

### 1. CIO (투자분석처장)
**언제 쓰나?** 매매 결정을 내리기 전 종합 판단할 때
**어떻게 쓰나?**
- `action=signal`로 매매 점수 빠르게 확인
- `action=full`로 전체 종합 분석 → 매매 시그널 발행 근거

**실전 시나리오:**
> CEO가 "삼성전자 지금 사도 돼?" 라고 물으면:
> 1. `technical_analyzer action=signal, name="삼성전자"` → 종합 점수 72/100 (매수)
> 2. `technical_analyzer action=full, name="삼성전자"` → 상세 근거 확인
> 3. `kr_stock action=price, name="삼성전자"` → 현재가 확인
> 4. 매매 시그널 발행: "매수 추천, 진입가 71,500원, 목표가 78,000원, 손절 67,000원"

### 2. 기술적분석 Specialist
**언제 쓰나?** CIO가 지시한 종목을 심층 분석할 때
**어떻게 쓰나?**
- `action=trend` → 현재 추세 방향 + 강도 파악
- `action=momentum` → 과매수/과매도 확인
- `action=pattern` → 최근 캔들 패턴으로 단기 방향 예측
- `action=support_resistance` → 매수/매도 가격대 설정

**실전 시나리오:**
> CIO가 "카카오 매수 타이밍 잡아줘" 라고 지시하면:
> 1. `action=trend` → ADX 32 (확실한 하락 추세), 20일선 아래
> 2. `action=momentum` → RSI 28 (과매도), MACD 히스토그램 축소 중
> 3. `action=support_resistance` → 피보나치 61.8% = 39,200원
> 4. `action=pattern` → 해머 캔들 출현
> 5. 보고: "하락 추세이나 RSI 과매도 + 해머 출현으로 39,200원 부근에서 기술적 반등 가능. 단기 매수 고려 가능하나, ADX 고려 시 추세 전환 확인 후 진입 권장"

---

## 파라미터 정리

| 파라미터 | 필수 | 타입 | 설명 |
|---------|------|------|------|
| action | O | string | full/trend/momentum/volatility/volume/pattern/support_resistance/signal |
| name | X | string | 종목명 (예: "삼성전자"). name 또는 ticker 중 하나 필요 |
| ticker | X | string | 종목코드 (예: "005930"). name 또는 ticker 중 하나 필요 |
| days | X | integer | 분석 기간 (기본값: 200일) |

## 주의사항
- **장 마감 후 데이터 기준**입니다. 실시간 호가가 아닙니다.
- 기술적 분석은 **확률의 도구**입니다. 100% 맞는 지표는 없습니다.
- `days` 값이 작으면 (30일 미만) 장기 지표(200일 MA 등)가 계산되지 않을 수 있습니다.
- 종목명으로 검색 시 pykrx의 ticker 변환을 사용합니다. 정확한 종목명을 입력하세요.
- LLM 분석이 포함되므로 kr_stock보다 응답 시간이 약간 더 걸립니다.
