# dart_monitor — 공시 알리미 도구 가이드

## 이 도구는 뭔가요?
금융감독원 전자공시시스템(DART)에서 관심 기업의 새로운 공시(기업이 의무적으로 공개하는 경영 정보)를 자동으로 감시하는 도구입니다. 관심 기업을 등록해두면, 새 공시가 올라올 때 자동으로 감지하고 주가에 미칠 영향까지 AI가 분석해줍니다.

## 어떤 API를 쓰나요?
- **금융감독원 DART OpenAPI** (https://opendart.fss.or.kr/)
- 비용: **무료** (일일 호출 횟수 제한 있음)
- 필요한 키: `DART_API_KEY`

## 사용법

### action=watch (관심 기업 등록)
```
action=watch, company="삼성전자"
```
- 감시 목록에 기업을 추가합니다.
- 기업명을 입력하면 DART 기업코드를 자동으로 매칭합니다.
- 부분 매칭도 지원합니다 (예: "삼성" 입력 시 "삼성전자" 매칭).

**예시:**
- `action=watch, company="현대차"` → 현대차를 감시 목록에 추가
- `action=watch, company="카카오"` → 카카오를 감시 목록에 추가

### action=unwatch (관심 기업 해제)
```
action=unwatch, company="삼성전자"
```
- 감시 목록에서 기업을 제거합니다.

**예시:**
- `action=unwatch, company="현대차"` → 현대차를 감시 목록에서 제거

### action=check (새 공시 확인)
```
action=check
```
- 등록된 모든 관심 기업의 새 공시를 한꺼번에 확인합니다.
- 새 공시가 있으면 AI가 각 공시의 주가 영향(호재/악재/중립)까지 분석합니다.
- 반환 정보: 기업별 새 공시 목록 (공시명, 접수일) + AI 영향 분석

**예시:**
- `action=check` → "삼성전자 — 새 공시 3건: [1] 분기보고서(2026-02-15)..."

### action=list (감시 목록 조회)
```
action=list
```
- 현재 감시 중인 기업 목록과 등록일을 보여줍니다.

**예시:**
- `action=list` → "공시 감시 목록 (3개 기업): 1. 삼성전자, 2. 현대차, 3. 카카오"

## 이 도구를 쓰는 에이전트들

### 1. 투자분석처장 (CIO)
**언제 쓰나?** 포트폴리오(보유 종목 묶음)에 포함된 기업들의 공시를 정기적으로 모니터링할 때
**어떻게 쓰나?**
- 주요 보유 종목을 watch로 등록해두고, 정기적으로 check를 실행하여 새 공시 확인
- 새 공시가 발생하면 AI 분석 결과를 바탕으로 팀원들에게 추가 분석 지시

**실전 시나리오:**
> CEO가 "삼성전자 관련 최근 이슈 알려줘" 라고 하면:
> 1. `action=watch, company="삼성전자"` 로 감시 등록 (이미 등록됐으면 생략)
> 2. `action=check` 로 최근 공시 확인
> 3. AI 분석 결과(호재/악재/중립)를 CEO에게 보고

### 2. 종목분석 Specialist
**언제 쓰나?** 특정 종목을 깊이 분석할 때, 최근 공시 내용을 파악하기 위해
**어떻게 쓰나?**
- 분석 대상 종목을 watch에 등록
- check로 최근 공시를 확인하여 재무제표 공시, 지분 변동 등 핵심 정보 파악
- dart_api 도구와 함께 사용하여 공시 원문까지 조회

**실전 시나리오:**
> CEO가 "카카오 지금 사도 될까?" 라고 하면:
> 1. `action=check` 로 카카오 최근 공시 확인 (실적, 자사주, 경영진 변동 등)
> 2. 공시 분석 결과를 dart_api(재무제표), kr_stock(현재가)과 종합하여 투자 의견 제시

## 주의사항
- DART API는 무료지만 **일일 호출 횟수 제한**이 있습니다. 너무 자주 check하면 제한에 걸릴 수 있습니다.
- 공시 데이터는 **실시간이 아닌 접수일 기준**입니다. 공시가 올라온 직후에는 반영이 늦을 수 있습니다.
- 감시 목록은 서버의 `data/dart_watchlist.json` 파일에 저장됩니다.
- 최초 사용 시 **기업코드 목록 다운로드**가 필요합니다 (자동 실행, 약 30초 소요). 이후에는 캐시를 사용합니다.
