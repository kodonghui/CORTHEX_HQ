# sentiment_scorer — 시장 감성 분석 도구 가이드

## 이 도구는 뭔가요?
"이 종목에 대한 시장 분위기가 좋은가 나쁜가?"를 **뉴스 기반 NLP(자연어 처리)**로 측정하는 도구입니다.
네이버 뉴스 API로 최신 헤드라인을 가져와서, **한국 금융 감성사전(64개 키워드)**으로 긍정/부정을 분석하고, 0~100 점수로 환산합니다.
네이버 API가 없으면 **LLM이 대신 분석**해주므로, API 키 없이도 동작합니다.

## 어떤 기술을 쓰나요?
| 기술 | 역할 |
|------|------|
| **네이버 뉴스 검색 API** | 종목/키워드 관련 최신 뉴스 30건 수집 |
| **한국어 금융 감성사전** | Loughran-McDonald 기반 한국어 버전. 긍정 32개 + 부정 32개 = **64개 키워드** |
| **감성 점수 계산** | 긍정/부정 단어 빈도 기반 -1~+1 → 0~100 정규화 |
| **LLM 폴백** | 네이버 API 없으면 LLM이 시장 감성 직접 분석 (Tetlock 2007 이론 활용) |
| **aiohttp** | 비동기 HTTP 요청 (네이버 API 호출) |

- 비용: **네이버 뉴스 검색 무료** (일 25,000건) + LLM 호출 비용 (GPT-5.2 기준 약 $0.01/분석)
- 환경변수: `NAVER_CLIENT_ID`, `NAVER_CLIENT_SECRET` (없어도 LLM 폴백으로 동작)

## 감성사전 키워드 (64개)

### 긍정 키워드 (32개)
상승, 급등, 호조, 성장, 개선, 흑자, 최고, 기대, 호실적, 서프라이즈, 돌파, 반등, 회복, 확대, 수혜, 호재, 강세, 신고가, 매수, 추천, 목표가상향, 실적개선, 턴어라운드, 수주, 계약, 합의, 승인, 특허, 혁신, 인수, 투자, 확장

### 부정 키워드 (32개)
하락, 급락, 부진, 감소, 적자, 최저, 우려, 악재, 실적부진, 쇼크, 이탈, 폭락, 위축, 축소, 리스크, 약세, 신저가, 매도, 하향, 목표가하향, 실적악화, 부실, 손실, 제재, 소송, 파산, 해고, 철수, 중단, 논란, 의혹

## 점수 해석 기준

| 감성 점수 | 해석 | 시장 분위기 |
|-----------|------|------------|
| 70~100 | 매우 긍정적 | 강한 매수 분위기 |
| 55~69 | 긍정적 | 매수 우위 |
| 45~54 | 중립 | 관망 |
| 30~44 | 부정적 | 매도 우위 |
| 0~29 | 매우 부정적 | 강한 매도 분위기 |

## 사용법

### action=full (종합 감성 분석) — 가장 많이 쓰게 될 액션
```
action=full, name="삼성전자"
```
- 네이버 뉴스 30건을 가져와서 헤드라인 + 본문 요약을 감성사전으로 분석
- 긍정/중립/부정 비율, 자주 나오는 긍정/부정 키워드 Top 5 표시
- 최근 뉴스 헤드라인 10건을 감성 이모지와 함께 표시
- 마지막에 LLM이 **Tetlock(2007)** 이론 기반 교수급 해설 추가
- 네이버 API 키가 없으면 → LLM이 직접 감성 분석 수행 (폴백)

**출력 예시:**
```
=======================================================
 삼성전자 시장 감성 분석 (30건 뉴스)
=======================================================

▸ 종합 감성 점수: 68/100 점
  → 긍정적 (매수 우위)

▸ 감성 비율: 긍정 53% / 중립 30% / 부정 17%

▸ 긍정 키워드: 성장(8), 반등(5), 수주(4), 기대(3), 투자(3)
▸ 부정 키워드: 우려(3), 리스크(2)

▸ 최근 뉴스 헤드라인:
  🟢 삼성전자, 3분기 반도체 실적 서프라이즈...
  🟢 HBM 수주 확대로 성장 기대감...
  ⚪ 삼성전자 주가 횡보세 지속...
  🔴 반도체 업황 둔화 우려...

=======================================================
🎓 교수급 감성 분석
=======================================================
(LLM 분석 결과)
```

### action=news (뉴스 감성 분석)
```
action=news, name="카카오"
```
- `full`과 동일한 결과 (내부적으로 full을 호출)
- 뉴스 중심 분석이 필요할 때 명시적으로 사용

### action=market (시장 전체 분위기)
```
action=market
```
- 종목 없이 호출 — **한국 주식시장 전체**의 공포/탐욕 지수를 분석
- KOSPI, 원달러 환율, 금리, 외인 매매 동향을 LLM이 종합 분석
- 0~100 공포/탐욕 점수 산출 (0 = 극단적 공포, 100 = 극단적 탐욕)
- name 파라미터 불필요

### action=keyword (키워드 감성 트렌드)
```
action=keyword, name="반도체"
action=keyword, keyword="AI 반도체"
action=keyword, query="2차전지"
```
- 특정 키워드(종목이 아닌 테마/섹터)에 대한 감성 분석
- 뉴스 20건을 검색해서 해당 키워드의 시장 분위기 측정
- name, keyword, query 중 아무 파라미터나 사용 가능
- 네이버 API 없으면 LLM 폴백

---

## 이 도구를 쓰는 에이전트들

### 1. CIO (투자분석처장)
**언제 쓰나?** 매매 결정을 내리기 전 시장 분위기를 확인할 때
**어떻게 쓰나?**
- `action=full`로 종목별 감성 확인 → technical_analyzer와 조합해서 매매 판단
- `action=market`로 시장 전체 분위기 파악 → 공포 시 매수 기회, 탐욕 시 리스크 관리

**실전 시나리오:**
> CEO가 "삼성전자 시장 분위기 어때?" 라고 물으면:
> 1. `sentiment_scorer action=full, name="삼성전자"` → 감성 점수 68/100 (긍정적)
> 2. `technical_analyzer action=signal, name="삼성전자"` → 매매 점수 72/100 (매수)
> 3. 종합 판단: "뉴스 감성 긍정(68점) + 기술적 매수(72점) → 매수 추천"
>
> CEO가 "지금 시장 분위기는?" 이라고 물으면:
> 1. `sentiment_scorer action=market` → 공포/탐욕 35 (공포 구간)
> 2. 판단: "시장 공포 구간 — 역발상 매수 기회이나, 추가 하락 리스크도 존재"

### 2. 시황분석 Specialist
**언제 쓰나?** CIO에게 일일/주간 시장 보고를 올릴 때
**어떻게 쓰나?**
- `action=market`로 전체 시장 분위기 파악
- `action=keyword`로 주요 섹터(반도체, 2차전지, 바이오 등) 감성 비교
- `action=full`로 CIO가 지정한 종목의 뉴스 감성 심층 분석

**실전 시나리오:**
> CIO가 "이번 주 반도체 섹터 분위기 분석해줘" 라고 지시하면:
> 1. `action=keyword, keyword="반도체"` → 감성 점수 72/100 (긍정)
> 2. `action=keyword, keyword="HBM"` → 감성 점수 81/100 (매우 긍정)
> 3. `action=keyword, keyword="파운드리"` → 감성 점수 42/100 (부정)
> 4. `action=full, name="삼성전자"` → 68점, `name="SK하이닉스"` → 75점
> 5. 보고: "반도체 섹터 전체 긍정(72점), 특히 HBM 매우 긍정(81점). 반면 파운드리는 부정(42점) — 수요 둔화 우려 뉴스 다수. SK하이닉스(75점)가 삼성전자(68점)보다 시장 기대 높음"

---

## 파라미터 정리

| 파라미터 | 필수 | 타입 | 설명 |
|---------|------|------|------|
| action | O | string | full / news / market / keyword |
| name | X | string | 종목명 또는 키워드 (예: "삼성전자", "반도체"). full/news에서는 종목명, keyword에서는 키워드 |
| keyword | X | string | 키워드 (action=keyword일 때 name 대신 사용 가능) |
| query | X | string | 검색어 (name, keyword 모두 비었을 때 폴백) |

- `action=market`은 name 파라미터 없이 호출합니다.
- `action=full`과 `action=news`는 반드시 name이 필요합니다.
- `action=keyword`는 name, keyword, query 중 하나만 있으면 됩니다.

## 주의사항
- **네이버 API 키(`NAVER_CLIENT_ID`, `NAVER_CLIENT_SECRET`)가 없으면** 뉴스 수집 없이 LLM이 직접 분석합니다. 정확도가 떨어질 수 있습니다.
- 감성사전은 **헤드라인 수준의 짧은 텍스트에 최적화**되어 있습니다. 장문 분석에는 한계가 있습니다.
- 감성 분석은 **현재 시장 분위기의 "온도계"**입니다. 미래 주가를 예측하는 도구가 아닙니다.
- Tetlock(2007) 연구에 따르면, 뉴스 감성은 **단기(1~5일) 수익률과 상관관계**가 있지만, 장기적으로는 약해집니다.
- 뉴스 검색 결과는 **최신순 정렬**이므로, 오래된 이슈보다 최근 이슈에 가중치가 높습니다.
- `action=market`은 LLM이 실시간 데이터 없이 분석하므로, 참고용으로만 활용하세요.
