# security_scanner — 보안 취약점 스캐너 도구 가이드

## 이 도구는 뭔가요?
우리 프로젝트에서 사용하는 외부 라이브러리(패키지)에 알려진 보안 구멍(취약점)이 있는지 검사하는 도구입니다.
해커가 악용할 수 있는 취약점을 자동으로 찾아내고, 어떤 버전으로 업데이트하면 해결되는지 알려줍니다.

## 어떤 API를 쓰나요?
- **OSV API** (https://osv.dev) — Google이 운영하는 오픈소스 취약점 데이터베이스
- **PyPI API** (https://pypi.org) — Python 패키지 저장소의 취약점 정보
- **pip-audit** — 로컬에 설치되어 있으면 우선 사용 (더 정확함)
- 비용: **무료** (모든 API가 무료 공개)
- 필요한 키: 없음

## 사용법

### action=scan (전체 취약점 스캔)
```
action=scan, requirements_file="requirements.txt"
```
- `requirements.txt` 파일에 나열된 모든 패키지의 취약점을 검사합니다
- `requirements_file`: 검사할 파일 경로 (기본값: "requirements.txt")
- pip-audit가 설치되어 있으면 먼저 사용하고, 없으면 OSV API로 검사합니다
- 각 취약점의 심각도(높음/중간/낮음), 취약점 ID, 해결 방법을 표시합니다

**예시:**
- `action=scan` → 전체 패키지 스캔 결과: "총 50개 패키지, 취약점 2개 발견, 안전 48개"

### action=check_package (특정 패키지 취약점 확인)
```
action=check_package, package="requests", version="2.28.0"
```
- 특정 패키지의 특정 버전에 알려진 취약점이 있는지 확인합니다
- `package`: 패키지 이름 (필수)
- `version`: 버전 (기본값: "latest" = 최신 버전)
- 취약점이 있으면 심각도, ID, 설명, 해결 버전을 표시합니다

**예시:**
- `action=check_package, package="flask", version="2.0.0"` → 해당 버전의 취약점 목록 반환

### action=report (전체 보안 보고서)
```
action=report, requirements_file="requirements.txt"
```
- 스캔 결과를 기반으로 AI가 분석한 종합 보안 보고서를 생성합니다
- 전체 보안 상태 평가, 즉시 조치 사항, 구체적 해결 방법, 장기 개선 권고를 포함합니다
- 비개발자도 이해할 수 있는 한국어로 작성됩니다

**예시:**
- `action=report` → 스캔 결과 + AI 분석이 합쳐진 종합 보안 보고서

## 이 도구를 쓰는 에이전트들

### 1. 기술개발처장 (CTO)
**언제 쓰나?** 프로젝트 보안 상태를 전체적으로 점검하고 CEO에게 보고할 때
**어떻게 쓰나?**
- `action=report`로 종합 보안 보고서 생성
- 취약점 발견 시 수정 우선순위를 결정하여 팀에 지시

**실전 시나리오:**
> CEO가 "우리 서비스 보안은 괜찮아?" 라고 하면:
> 1. `action=report`로 전체 보안 보고서 생성
> 2. 심각도가 '높음'인 취약점이 있으면 즉시 수정 계획 수립
> 3. CEO에게 "현재 N개 취약점 발견, 긴급 M개는 이번 주 내 수정 예정" 보고

### 2. 백엔드/API Specialist
**언제 쓰나?** 새 패키지를 추가하거나, 정기적인 보안 점검 시
**어떻게 쓰나?**
- 새 패키지 도입 전 `action=check_package`로 사전 점검
- `action=scan`으로 전체 의존성 취약점 확인

**실전 시나리오:**
> 새 라이브러리를 추가하려고 할 때:
> 1. `action=check_package, package="새패키지", version="1.0.0"`으로 사전 점검
> 2. 취약점이 있으면 안전한 버전으로 변경 후 사용

### 3. DB/인프라 Specialist
**언제 쓰나?** 배포 전 보안 점검, 서버 인프라의 의존성 관리 시
**어떻게 쓰나?**
- 배포 전 `action=scan`으로 최종 보안 점검
- 주기적인 보안 감사(audit) 시 사용

**실전 시나리오:**
> 정기 보안 감사 시:
> 1. `action=scan`으로 전체 패키지 취약점 확인
> 2. 발견된 취약점을 심각도별로 분류
> 3. CTO에게 "높음 0건, 중간 2건, 낮음 1건 — 조치 필요 항목 상세" 보고

## 주의사항
- `requirements.txt` 파일에 `==`으로 버전이 고정된 패키지만 정확한 검사가 가능합니다
- `>=`이나 버전 미지정 패키지는 "latest"로 처리되어 정확도가 낮을 수 있습니다
- pip-audit가 서버에 설치되어 있으면 더 정확한 결과를 얻을 수 있습니다
- OSV API는 알려진(공개된) 취약점만 검사합니다 — 아직 알려지지 않은 취약점(제로데이)은 감지 못합니다
- 취약점 심각도는 CVSS 점수 기반: 7.0 이상 = 높음, 4.0~6.9 = 중간, 4.0 미만 = 낮음
