# code_quality — 코드 품질 검사 도구 가이드

## 이 도구는 뭔가요?
코드에 보안 취약점(해킹 위험), 스타일 문제(지저분한 코드), 테스트 실패가 없는지
자동으로 검사해주는 도구입니다.
실제로 시니어 개발자가 코드 리뷰할 때 자동화 도구를 돌리는 것과 같습니다.

## 어떤 기술을 쓰나요?
3가지 검사 도구를 내부적으로 사용합니다:

| 검사 도구 | 뭘 검사하나 | 비유 |
|---|---|---|
| **bandit** | 보안 취약점 (해킹 위험한 코드) | "자물쇠가 잠겼는지 확인" |
| **ruff** | 코드 스타일 (문법, 형식) | "맞춤법 검사" |
| **pytest** | 테스트 (코드가 제대로 작동하는지) | "시험 보기" |

- 비용: **완전 무료** (로컬에서 실행, API 키 불필요)
- 해당 도구가 설치되어 있어야 합니다.

## 사용법

### action=security (보안 검사)
```
action=security
```
- bandit으로 보안 취약점 스캔
- "하드코딩된 비밀번호", "SQL 인젝션 위험", "안전하지 않은 함수" 등 검출
- 제한시간: 60초

### action=lint (코드 스타일 검사)
```
action=lint
```
- ruff로 코드 스타일/문법 검사
- 사용하지 않는 변수, 잘못된 들여쓰기, PEP8 위반 등 검출
- 제한시간: 60초

### action=test (테스트 실행)
```
action=test
```
- pytest로 테스트 코드 실행
- 통과/실패 결과 반환
- 제한시간: 300초 (5분)

### action=all (전체 검사)
```
action=all
```
- 위 3가지(보안 + 스타일 + 테스트)를 한번에 실행
- "배포 전 최종 점검"에 사용

---

## 이 도구를 쓰는 에이전트들

### 1. 백엔드/API Specialist
**언제 쓰나?** 코드를 작성하거나 수정한 후
**어떻게 쓰나?**
- 코드 작성 후 → `action=lint` → 스타일 문제 수정
- 기능 완성 후 → `action=test` → 테스트 통과 확인
- 배포 전 → `action=all` → 전체 최종 점검
- github_tool(이슈)과 함께 → 이슈 확인 + 수정 + 품질 검사 워크플로우

**실전 시나리오:**
> 새 API 엔드포인트를 추가한 후:
> 1. `code_quality action=lint` → "미사용 import 2건, 줄 길이 초과 1건"
> 2. 문제 수정
> 3. `code_quality action=test` → "전체 45개 테스트 통과"
> 4. `code_quality action=security` → "보안 이슈 없음"
> 5. **결론:** "코드 품질 검사 통과, 배포 준비 완료"

### 2. DB/인프라 Specialist
**언제 쓰나?** 배포 전 최종 "품질 게이트" 역할
**어떻게 쓰나?**
- `action=all`로 전체 점검 실행
- 보안 이슈가 있으면 → 배포 중단하고 백엔드 Specialist에게 수정 요청
- 테스트 실패가 있으면 → 배포 중단

**실전 시나리오:**
> 배포 전 최종 확인:
> 1. `code_quality action=all`
> 2. 결과: "보안: 이슈 0건, 린트: 경고 3건(사소), 테스트: 45/45 통과"
> 3. **판단:** "배포 가능 상태. 린트 경고는 다음 스프린트에서 정리"

---

## 주의사항
- bandit, ruff, pytest가 설치되어 있어야 합니다. 없으면 해당 검사를 건너뜁니다.
- 테스트는 최대 5분까지 실행됩니다. 오래 걸리는 테스트는 타임아웃될 수 있습니다.
- 보안 검사 결과가 "위험"이라고 해서 무조건 해킹당하는 건 아닙니다. 맥락을 고려하세요.
