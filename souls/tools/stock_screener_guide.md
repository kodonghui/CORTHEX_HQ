# stock_screener — 종목 스크리너 도구 가이드

## 이 도구는 뭔가요?
한국 주식시장(코스피/코스닥)에 상장된 전체 종목을 PER(주가수익비율), PBR(주가순자산비율), 시가총액, 거래량 등의 조건으로 자동 필터링하는 도구입니다. "이런 조건에 맞는 종목을 찾아줘"라고 하면, 수천 개 종목 중에서 조건에 맞는 종목만 골라줍니다.

## 어떤 API를 쓰나요?
- **pykrx** (한국거래소 데이터 라이브러리)
- 비용: **무료** (API 키 불필요)
- 필요한 키: 없음

## 사용법

### action=screen (조건 필터링)
```
action=screen, market="ALL", min_market_cap=1000, max_per=10, min_per=0.1, min_volume=10000, top_n=20
```
- 입력한 조건에 맞는 종목을 필터링합니다.
- 결과는 시가총액 순으로 정렬됩니다.
- AI가 결과 종목들의 공통 특징과 주목할 종목을 분석해줍니다.

**파라미터:**
| 파라미터 | 설명 | 기본값 |
|---------|------|--------|
| market | 시장 선택: "KOSPI", "KOSDAQ", "ALL" | "ALL" |
| min_market_cap | 최소 시가총액 (억원) | 0 |
| max_per | 최대 PER (이보다 비싼 종목 제외) | 9999 |
| min_per | 최소 PER (적자기업 제외용, 0 이상) | 0 |
| min_volume | 최소 일평균 거래량 | 0 |
| top_n | 결과 개수 | 20 |

**예시:**
- `action=screen, min_market_cap=5000, max_per=15` → 시총 5000억 이상, PER 15 이하 종목
- `action=screen, market="KOSDAQ", min_volume=100000` → 코스닥에서 거래량 10만주 이상

### action=preset (프리셋 전략)
```
action=preset, strategy="value"
```
- 미리 정의된 투자 전략으로 스크리닝합니다.
- 별도 조건 입력 없이 전략명만 지정하면 됩니다.

**사용 가능한 전략:**
| 전략명 | 설명 | 핵심 조건 |
|--------|------|----------|
| value | 가치주 (저평가 종목) | 시총 1000억+, PER 0.1~10, 거래량 1만+ |
| growth | 성장주 (성장 가능성) | 시총 500억+, PER 5~30, 거래량 5만+ |
| dividend | 배당주 (배당 수익) | 시총 3000억+, PER 0.1~20, 거래량 1만+ |
| momentum | 모멘텀 (거래 활발) | 시총 1000억+, PER 0.1~50, 거래량 50만+ |

**예시:**
- `action=preset, strategy="value"` → 저PER+저PBR 가치주 상위 20개
- `action=preset, strategy="dividend", market="KOSPI"` → 코스피 배당주 상위 20개

## 이 도구를 쓰는 에이전트들

### 1. 투자분석처장 (CIO)
**언제 쓰나?** 새로운 투자 대상을 발굴하거나, 시장 전반의 밸류에이션(가치 평가) 수준을 파악할 때
**어떻게 쓰나?**
- preset 전략으로 빠르게 시장을 스캔
- screen으로 세부 조건을 조합하여 종목 발굴

**실전 시나리오:**
> CEO가 "지금 시장에서 싼 종목 좀 찾아줘" 라고 하면:
> 1. `action=preset, strategy="value"` 로 가치주 스크리닝
> 2. 결과 중 주목할 종목을 종목분석 Specialist에게 심층 분석 지시

### 2. 종목분석 Specialist
**언제 쓰나?** 동종업체 비교 분석(Peer Comparison)이 필요할 때
**어떻게 쓰나?**
- 분석 대상 종목과 같은 업종의 다른 종목들을 screen으로 필터링
- PER/PBR 비교를 통해 상대적으로 저평가/고평가 판단

**실전 시나리오:**
> CEO가 "삼성전자가 동종업체 대비 비싼 편이야?" 라고 하면:
> 1. dart_api로 삼성전자의 업종(반도체) 확인
> 2. `action=screen, min_market_cap=1000, max_per=30` 으로 비슷한 규모 종목 스크리닝
> 3. 삼성전자의 PER/PBR과 동종업체 평균을 비교하여 상대 가치 판단

## 주의사항
- 스크리닝은 **과거 데이터 기반**입니다. 최근 거래일 데이터를 사용하므로, 주말/공휴일에는 전날 데이터를 사용합니다.
- PER 0 또는 음수인 종목은 **적자 기업**입니다. min_per=0.1로 설정하면 적자 기업을 제외할 수 있습니다.
- 배당수익률이 비정상적으로 높은 종목(10% 이상)은 **배당 함정**(일시적 특별배당 등)일 수 있으므로 주의가 필요합니다.
- pykrx 라이브러리가 서버에 설치되어 있어야 합니다.
